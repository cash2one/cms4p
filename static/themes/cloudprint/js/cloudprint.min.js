var config={countdown:{year:2013,month:9,day:10,hours:9,minutes:0,seconds:0},subscription_form_tooltips:{success:"恭喜您，订阅成功!",default_error:"抱歉，请稍后重试.",empty_email:"请输入您的 Email 邮箱地址.",invalid_email:"Email 邮箱地址格式貌似有点奇葩.",already_subscribed:"您貌似已经订阅过了, 感谢您的关注."}};$("#container").imagesLoaded().progress(function(a,b){b.fadeIn("slow")});$(function(){var c=new Date(config.countdown.year,config.countdown.month-1,config.countdown.day,config.countdown.hours,config.countdown.minutes,config.countdown.seconds),d=$("body"),k=$("#countdown");k.countdown(c,function(m){if(m.type=="finished"){k.fadeOut()}else{$(".countdown-"+m.type,k).text(m.value)}});var e=config.subscription_form_tooltips,j=false,l=$("#subscribe-form"),g=$("#subscribe-email"),a=$("#subscribe-submit"),f;function b(m,n){if(!f){f=$('<p id="subscribe-tooltip" class="subscribe-tooltip"></p>').appendTo(l).hide()}if(m=="success"){f.removeClass("error").addClass("success")}else{f.removeClass("success").addClass("error")}f.text(n).fadeIn(200)}function i(){if(f){f.fadeOut(200)}}function h(m,n){g.removeClass("success error");if(m=="normal"){i()}else{b(m,n);g.addClass(m)}}l.submit(function(n){n.preventDefault();var m=g.val();if(m.length==0){h("error",e.empty_email)}else{$.post("/subscribe",{email:m,ajax:1},function(o){if(o.status==200){h("success",e.success)}else{switch(o.error){case"empty_email":case"invalid_email":case"already_subscribed":h("error",e[o.error]);break;default:h("error",e.default_error);break}}},"json")}});g.on("change focus click keydown",function(){if(g.val().length>0){h("normal")}})});